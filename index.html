<!doctype html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <!-- Pyodide -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.28.2/full/pyodide.js"></script>
    <!-- bokeh + panel runtime (versions should match wheel versions below) -->
    <script src="https://cdn.bokeh.org/bokeh/release/bokeh-3.8.1.js"></script>
    <script src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.8.1.min.js"></script>
    <script src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.8.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@holoviz/panel@1.8.3/dist/panel.min.js"></script>
</head>
<body>
  <!-- ‚úÖ Loading splash screen -->
  <div id="loading" style="
    font-family: sans-serif;
    padding: 1.2rem;
    text-align: center;
  ">
      üîß Loading Python environment‚Ä¶ please wait‚Ä¶
  </div>

  <!-- The Panel app will replace/overwrite this -->
  <div id="app"></div>

  <!-- Your existing JS loader below -->
  <script>
    async function boot() {
      try {
        const pyodide = await loadPyodide();
        document.getElementById("loading").innerText = "Downloading packages‚Ä¶";

        await pyodide.loadPackage("micropip");
        const micropip = pyodide.pyimport("micropip");
        await micropip.install([
          "https://cdn.holoviz.org/panel/wheels/bokeh-3.8.1-py3-none-any.whl",
          "https://cdn.holoviz.org/panel/wheels/panel-1.8.3-py3-none-any.whl"
        ]);

        // fetch and run your Python code (main.py)
        const code = await (await fetch("main.py")).text();
        await pyodide.runPythonAsync(code);

        // ‚úÖ hide loading once Python has rendered the app
        document.getElementById("loading").style.display = "none";

      } catch (err) {
        document.getElementById("loading").innerText =
          "‚ùå Failed to load app (see console).";
        console.error(err);
      }
    }

    boot();
  </script>
</body>
